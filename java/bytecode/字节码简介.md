# 字节码介绍

- > Jvm虚拟机本质上是一个极其复杂的状态机程序，关于什么是状态机可以参考bilibili Up主 [绿导师原谅你了](https://space.bilibili.com/202224425?spm_id_from=333.999.0.0)，他的操作系统课程可以帮助你更好理解程序是什么。
- > 字节码对标的是普通机器上的汇编语言。针对某一个平台编写的程序几乎无法无法在另一个平台上运行(转译层除外)，Java的出现可以保证适配了Java的平台都能够运行Java，没有适配Java的平台，一旦将Java植过去，那么就代表所有的Java程序都能够在上面运行，这也是它强大的跨平台兼容性的由来。

- Java语言中的八大基本数据类型和Java虚拟机中的数据类型
    - Java语言中八大基本数据类型
        - > 整型: byte shore int long
        - > 浮点型: double float
        - > 字符型: char
        - > 布尔型: boolean
        - Java虚拟机中的数据类型
            - > 引用类型(reference type)
            - > 原始类型(primitive type)
- 原始类型被称为值类型，引用类型同引用类型
  1. 原始类型包括: byte short int long char float double
     1. boolean的值有两种:true和false，零值为false，虽然虚拟机中定义了boolean这种原始类型，但是却没有指令直接支持其操作。
     2. 所以，对boolean类型在虚拟机中还是使用int类型来表示 1表示true 0表示false。
     3. returnAddress类型表示一个指向操作码的指针，此操作码与虚拟机指令相对应。
     4. 从以上可以看出，在Java虚拟机的**原始类型**中，除了returnAddress，其余都和八大基本数据类型一一对应。那么**引用类型**呢？很明显，**引用类型**与Java中对象引用有关，在虚拟机中，对象表示为某个累的实例或者是某个数组，指向次对象就用引用类型来表示。reference类型的值，可以当作指向内存中此对象的指针，每个对象可能存在多个指向它的指针，对象的操作、检查、传递都通过引用它的指针来进行。
     5. tips:（引用类型其实就是对指针的阉割版本，将指针的引用程序化管理而不是人工操作，这样做能够大大减少开发人员的心智负担，同时也是Java是值传递还是引用传递之争的由来）
        1. 一派认为所有的内容都是传递的值，包括引用时的指针复制和赋值都属于复制。
        2. 一派认为八大基本类型都是值传递，到了引用类型就变为了引用传递。
        3. **评价**
           1. 这里把复制的概念扩大到指针了，他们认为指针的引用也是传递值，也就是复制指针的值给另一个变量，也就是类似于开辟了一个内存来存放这个引用(指针)，这要是一直扯下去C语言的指针也会变成值传递。
           2. 第二派的观点差不多能够解释大部分，但是方法调用的参数列表是单独开的一个内存空间，空间也是变量，里面存放的引用，把空间变量里的引用替换了自然无法影响到原引用数据。
        4. 不要管那么多，自己写一个状态机（将状态机实现到方法调用）就明白这些概念了，想要直接传递引用，并且能将引用替换为另一个引用可以选择字节码增强，这些特性真的只是看编译器怎么编译，他们是犯了一种非要界定概念的一种病。隔壁C#和Java一样，但是就没Java吵得那么厉害。

- Java字节码指令包括
    - 加载和存储指令
    - 类型转换指令
    - 对象创建与访问指令
    - 操作数栈管理指令
    - 控制转移指令
    - 方法调用和返回指令
    - 异常处理指令和同步指令
